<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Inventaris SKB Muara Badak</title>
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

<style>
body{font-family:Arial;background:#f1f5f9;margin:0}
.hidden{display:none}
header{background:#1e40af;color:#fff;padding:12px;display:flex;justify-content:space-between;align-items:center}
.container{padding:20px}
.card{background:#fff;padding:20px;border-radius:12px;margin-bottom:20px;box-shadow:0 4px 10px rgba(0,0,0,.1)}
table{width:100%;border-collapse:collapse;margin-top:10px}
th,td{border:1px solid #ddd;padding:6px;text-align:center}
th{background:#e5e7eb}
input,select,button{padding:6px;margin:4px;width:100%}
button{border:none;border-radius:6px;cursor:pointer}
.primary{background:#2563eb;color:#fff}
.success{background:#16a34a;color:#fff}
.danger{background:#dc2626;color:#fff}
.logout{background:#f59e0b;color:#fff}
.menu{display:flex;gap:10px;flex-wrap:wrap}
</style>
</head>

<body>

<div id="loginBox" class="card" style="max-width:400px;margin:40px auto;text-align:center">
<h3>Inventaris SKB Muara Badak</h3>
<input id="user" placeholder="Username">
<input id="pass" type="password" placeholder="Password">
<button class="primary" onclick="login()">Login</button>
</div>

<div id="app" class="hidden">
<header>
<h3>Dashboard Inventaris</h3>
<button class="logout" onclick="logout()">Logout</button>
</header>

<div class="container">

<div class="card menu">
<button class="primary" onclick="show('masuk')">Barang Masuk</button>
<button class="danger" onclick="show('keluar')">Barang Keluar</button>
</div>

<!-- BARANG MASUK -->
<div class="card hidden" id="masuk">
<h3>Barang Masuk</h3>
<input id="mBarang" placeholder="Nama Barang">

<select id="mJenis" multiple>
<option>Barang Modal</option>
<option>BAJAS</option>
</select>

<select id="mDana" multiple>
<option>BOSKAB 1</option>
<option>BOSKAB 2</option>
<option>BOP 1</option>
<option>BOP 2</option>
<option>Dana Lainnya</option>
</select>

<input type="number" id="mJumlah" placeholder="Jumlah">

<select id="mSatuan">
<option>rim</option><option>buah</option><option>pcs</option>
<option>botol</option><option>paket</option><option>unit</option>
</select>

<button class="success" onclick="barangMasuk()">Simpan</button>
</div>

<!-- BARANG KELUAR -->
<div class="card hidden" id="keluar">
<h3>Barang Keluar</h3>

<select id="kBarang"></select>
<input type="number" id="kJumlah" placeholder="Jumlah">

<select id="kSatuan">
<option>rim</option><option>buah</option><option>pcs</option>
<option>botol</option><option>paket</option><option>unit</option>
</select>

<select id="kJenis" multiple></select>
<select id="kDana" multiple></select>

<select id="kAmbil">
<option>Bu Munawarah. S.Pd</option>
<option>Bu Liliana Sataria. S.Kom</option>
<option>Bu Fatimah. S.Pd</option>
<option>Pak Jemidin. S.Pd., M.Pd</option>
</select>

<button class="danger" onclick="barangKeluar()">Simpan</button>
</div>

<!-- DATA -->
<div class="card">
<h3>Data Inventaris</h3>
<table id="tabel"></table>
</div>

<!-- DOWNLOAD -->
<div class="card">
<h3>Download Excel</h3>

<select id="fTipe">
<option value="">Semua</option>
<option value="Masuk">Barang Masuk</option>
<option value="Keluar">Barang Keluar</option>
</select>

<select id="fJenis"></select>
<select id="fDana"></select>

<button class="primary" onclick="downloadExcel()">Download</button>
</div>

</div>
</div>

<script>
let data=[];

function login(){
if(user.value && pass.value){
loginBox.classList.add("hidden");
app.classList.remove("hidden");
}
}

function logout(){location.reload()}
function show(id){
masuk.classList.add("hidden");
keluar.classList.add("hidden");
document.getElementById(id).classList.remove("hidden");
}

function multi(id){
return [...document.getElementById(id).selectedOptions].map(o=>o.value);
}

function barangMasuk(){
data.push({
tipe:"Masuk",
barang:mBarang.value,
jenis:multi("mJenis"),
dana:multi("mDana"),
jumlah:mJumlah.value,
satuan:mSatuan.value
});
update();
}

function barangKeluar(){
data.push({
tipe:"Keluar",
barang:kBarang.value,
jenis:multi("kJenis"),
dana:multi("kDana"),
jumlah:kJumlah.value,
satuan:kSatuan.value,
ambil:kAmbil.value
});
update();
}

function update(){
let t="<tr><th>Tipe</th><th>Barang</th><th>Jenis</th><th>Dana</th><th>Jumlah</th><th>Pengambil</th><th>Aksi</th></tr>";
data.forEach((d,i)=>{
t+=`<tr>
<td>${d.tipe}</td>
<td>${d.barang}</td>
<td>${d.jenis.join(", ")}</td>
<td>${d.dana.join(", ")}</td>
<td>${d.jumlah} ${d.satuan}</td>
<td>${d.ambil||""}</td>
<td>${d.tipe=="Keluar"?`<button onclick="hapus(${i})">Hapus</button>`:""}</td>
</tr>`;
});
tabel.innerHTML=t;

kBarang.innerHTML=[...new Set(data.filter(d=>d.tipe=="Masuk").map(d=>d.barang))]
.map(b=>`<option>${b}</option>`).join("");

kJenis.innerHTML=mJenis.innerHTML;
kDana.innerHTML=mDana.innerHTML;
fJenis.innerHTML='<option value="">Semua</option>'+mJenis.innerHTML;
fDana.innerHTML='<option value="">Semua</option>'+mDana.innerHTML;
}

function hapus(i){data.splice(i,1);update()}

function downloadExcel(){
let tipe=fTipe.value, j=fJenis.value, d=fDana.value;
let out=data.filter(x=>
(!tipe||x.tipe==tipe)&&
(!j||x.jenis.includes(j))&&
(!d||x.dana.includes(d))
).map(x=>({
Tipe:x.tipe,
Barang:x.barang,
Jenis:x.jenis.join(", "),
Dana:x.dana.join(", "),
Jumlah:x.jumlah+" "+x.satuan,
Pengambil:x.ambil||""
}));
let ws=XLSX.utils.json_to_sheet(out);
let wb=XLSX.utils.book_new();
XLSX.utils.book_append_sheet(wb,ws,"Data");
XLSX.writeFile(wb,"inventaris.xlsx");
}
</script>

</body>
</html>
